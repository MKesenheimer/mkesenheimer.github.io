<!DOCTYPE html>
<html lang="en">

<head>
    <base href="/mkesenheimer.github.io/" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#002241" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#002241" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="theme-color" content="#ffffff" />
    <link rel="stylesheet" media="all" href="/Resources/Static/Packages/matthias.kesenheimer/Styles/prism.css" />
    <link rel="stylesheet" media="all" href="/Resources/Static/Packages/matthias.kesenheimer/Styles/Main.min.css" />

    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/jQuery.js"></script>
    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/Plugins/anime.min.js" defer></script>
    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/Plugins/prism.js" defer></script>
    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/Plugins/chart.js" defer></script>
    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/Main.js" defer></script>
    <title>Physik, Elektronik und mehr... | Blog</title>
    <meta name="robots" content="index,follow" />
</head>

<body class>
    <div id="wrapper">
        <div id="header">
            <div class="menu">
                <nav class="paddingTop30 paddingBottom15 kesenheimer-menu">
                    <menu-ul>
                        <li class=""><a href="/about-me.html">Ãœber mich</a></li>
                        <li class="current"><a href="/">Blog</a></li>
                        <li class=""><a href="/empty.html">Leer</a></li>
                        <li class=""><a href="/contact.html">Kontakt</a></li>
                    </menu-ul>
                </nav>
            </div>
        </div>

        <section id="content">
            <div class="neos-contentcollection">
                <div class="paddingTop0 paddingBottom30 kesenheimer-container">
                    <div class="inner container-fluid">
                        <div class="neos-contentcollection">
                            <div class="paddingTop0 paddingBottom0 kesenheimer-headline">
                                <div>
                                    <h1 style="text-align: center">Glitching the Raspberry Pico with a Raspberry Pico</h1>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Block -->
                <div class="color-white paddingTop0 paddingBottom0 kesenheimer-container">
                    <div class="inner container-fluid">
                        <div class="neos-contentcollection">
                            <!-- Text -->
                            <div class="neos-nodetypes-html">
                                <div class="paddingTop30 paddingBottom15 kesenheimer-text">
                                    <div>
                                        <div class="paddingTop0 paddingBottom15 kesenheimer-warning">
                                            <div>
                                                <p>I am now selling the PicoGlitcher on <a href="https://www.tindie.com/products/faulty-hardware/picoglitcher-v11/">tindie.com</a>.</p>
                                                
                                                <p>More links:</p>
                                                <ul>
                                                    <li>The Pico Glitcher and findus (the software to control the Pico Glitcher) is open source: <a href="https://github.com/MKesenheimer/fault-injection-library">fault-injection-library</a></li>
                                                    <li>Documentation of the Pico Glitcher and findus: <a href="https://fault-injection-library.readthedocs.io/en/latest/">fault-injection-library.readthedocs.io</a></li>
                                                    <li>hackaday.io project page: <a href="https://hackaday.io/project/196357-picoglitcher">hackaday.io/project/196357-picoglitcher</a></li>
                                                    <li>The Pico Glitcher was featured on Hackaday: <a href="https://hackaday.com/2024/10/30/use-picoglitcher-for-voltage-glitching-attacks/">hackaday.com/2024/10/30/use-picoglitcher-for-voltage-glitching-attacks/</a></li>
                                                </ul>
                                            </div>
                                        </div>

                                        <p>As you might have guessed by now, I'm a big fan of the Raspberry Pico microcontrollers. These microcontrollers are very easy to program (for example via Micropython), and still manage to be very powerful (see <a href="https://github.com/MKesenheimer/fault-injection-library">findus and the Pico Glitcher</a>).  Early on, I wondered whether this series of microcontrollers could be glitched. Besides, wouldn't it be damn cool to glitch the Raspberry Pico with a Raspberry Pico?</p>

                                        <p>The question was answered for me at the end of 2024 by Aedan Cullen, who gave a very interesting talk at 38C3. You should definitely watch his video on how to attack the rp2350. He goes into remarkable technical depth in this video (<a href="https://media.ccc.de/v/38c3-hacking-the-rp2350">link to the video</a>). In summary, he presented his research on fault injection of the rp2350.</p>

                                        <p>The question of whether the rp2350 is vulnerable should be answered in a competition. The Raspberry Foundation offered a bounty of $10,000 for those who could find a vulnerability in the boot mechanism (<a href="https://www.raspberrypi.com/news/raspberry-pi-pico-2-our-new-5-microcontroller-board-on-sale-now/">https://www.raspberrypi.com/news/raspberry-pi-pico-2-our-new-5-microcontroller-board-on-sale-now/</a>). The results of this challenge can be found at <a href="https://www.raspberrypi.com/news/security-through-transparency-rp2350-hacking-challenge-results-are-in/">https://www.raspberrypi.com/news/security-through-transparency-rp2350-hacking-challenge-results-are-in/</a>.</p>

                                        <p>The rp2350's security architecture includes several interrelated mechanisms that together provide authentication of code running on the chip, protected one-time-programmable memory, fine-grained control of debugging features, and so on. An anti-fuse OTP memory serves as the system's root of trust, informing the configuration of the ARM TrustZone and additional attack mitigations such as glitch detectors. Raspberry Pi even builds an impressive custom Redundancy Coprocessor (RCP) that hardens the execution of boot ROM code on the Cortex-M33 cores with stack protection, data validation and instruction latency randomisation.</p>

                                        <p>There you have it. Hacking the rp2350 should be impossible, right? Let's prove that wrong. In the following sections I will show how I verified the results by Aedan Cullen.</p>

                                        <div class="paddingTop0 paddingBottom15 kesenheimer-headline">
                                            <div>
                                                <h1>Preparing the target</h1>
                                            </div>
                                        </div>

                                        <p>I started working on a Pico board based on the example from Aedan Cullen. The first step was to remove the microcontroller from the board in order to access the traces.</p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/01-desoldering-preparing.JPG" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p>After the micrcontroller was removed, a special trace had to be cut with a scalpel. This later disconnects the USB_OTP_VDD pin from the power supply and allows any voltage to be applied to this pin.</p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/03-cutting-traces.jpg" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p>Here is a better resolution image. Unfortunately, I don't have a microscope to take the picture myself. So the credit goes to Aeden Cullen.</p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/04-pcb-aedan_cullen.png" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p>Finally, I used the very fine PCBite test probes to check whether there was a connection between the traces. If there was continuity, I would have to redo the cutting of the traces. Thanks at this point to Batronix GmbH & Co. KG, who gave me a discount on the PCBite set (<a href="https://www.batronix.com/shop/measurement/pcb-holder/sensepeek/6003-PCBite-kit-SQ10-LA.html">https://www.batronix.com/shop/measurement/pcb-holder/sensepeek/6003-PCBite-kit-SQ10-LA.html</a>).</p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/05-continuity-measurement.JPG" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p>After these steps, I put the microcontroller back on the PCB.</p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/06-preparation-finished.JPG" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <div class="paddingTop15 paddingBottom15 kesenheimer-headline">
                                            <div>
                                                <h1>Setup and current measurement</h1>
                                            </div>
                                        </div>

                                        <p></p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/08-glitching-setup-rp2350.JPG" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p></p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/09-glitching-setup-rp2350.JPG" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p></p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/10-glitching-setup.JPG" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p></p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/11-overall.JPG" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p></p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/12-voltage-trace.bmp" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p></p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/13-glitch1.bmp" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p></p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/14-glitch2.bmp" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p></p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/15-glitch3.bmp" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p></p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/16-parameterspace1.png" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p></p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/17-parameterspace2.png" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p></p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2025/02/18-success.png" width="3264" height="2448" />
                                            </figure>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row paddingTop0 paddingBottom0 neos-nodetypes-twocolumn">
                                <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12 is-page neos-contentcollection"></div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 is-page neos-contentcollection"></div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <section id="footer">
            <div class="copy">
                <div class="inner">
                    <div class="neos-contentcollection">
                        <div class="paddingTop15 paddingBottom15 kesenheimer-text">
                            <div>
                                <p style="text-align:center">
                                    <a href="/impressum.html">Impressum</a>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</body>
</html>
