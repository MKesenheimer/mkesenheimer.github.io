<!DOCTYPE html><html lang="en"><!--
	This website is powered by Neos, the Open Source Content Application Platform licensed under the GNU/GPL.
	Neos is based on Flow, a powerful PHP application framework licensed under the MIT license.

	More information and contribution opportunities at https://www.neos.io
-->
<head><meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="theme-color" content="#202040">
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
		<link rel="manifest" href="/site.webmanifest">
		<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#202040">
		<meta name="msapplication-TileColor" content="#ffffff">
		<meta name="theme-color" content="#ffffff">
		<link rel="stylesheet" media="all" href="https://mkesenheimer.github.io/mkesenheimer.github.io/_Resources/Static/Packages/matthias.kesenheimer/Styles/prism.css" />
		<link rel="stylesheet" media="all" href="https://mkesenheimer.github.io/mkesenheimer.github.io/_Resources/Static/Packages/matthias.kesenheimer/Styles/Main.min.css" />
		
			<script type="application/ld+json">
				{
					"@context": "https://schema.org",
					"@type": "BlogPosting",
					"headline": "Why the .git folder is dangerous (a showcase)",
					"image": [
						"_Resources/Static/Packages/matthias.kesenheimer/Images/easter_egg.png"
					],
					"author" :{
						"@type": "Person",
						"name":"Matthias Kesenheimer",
						"email":"contact@renerehme.de"
					},
					"datePublished": "2022-06-03T00:00:00+02:00",
					"dateModified": "2022-06-20T18:58:16+02:00",
					"publisher" : {
						"@type": "Organization",
						"name":"Matthias Kesenheimer",
						"url":"https:\/\/renerehme.de",
						"logo":{
							"@type":"ImageObject",
							"url":"_Resources/Static/Packages/matthias.kesenheimer/Images/easter_egg.png"
						}
					}
				}
			</script>
		
	
		<script src="/_Resources/Static/Packages/matthias.kesenheimer/JavaScript/jQuery.js"></script>
        <script src="/_Resources/Static/Packages/matthias.kesenheimer/JavaScript/Plugins/anime.min.js" defer></script>
        <script src="/_Resources/Static/Packages/matthias.kesenheimer/JavaScript/Plugins/prism.js" defer></script>
        <script src="/_Resources/Static/Packages/matthias.kesenheimer/JavaScript/Plugins/chart.js" defer></script>
        <script src="/_Resources/Static/Packages/matthias.kesenheimer/JavaScript/Main.js" defer></script>
    <title>Why the .git folder is dangerous (a showcase) - Blog - Matthias Kesenheimer</title><meta name="robots" content="index,follow" /><link rel="canonical" href="/index.html/blog/why-the-git-folder-is-dangerous" />
<link rel="alternate" hreflang="x-default" href="/index.html/blog/why-the-git-folder-is-dangerous" /><link rel="alternate" hreflang="de" href="/index.html/blog/why-the-git-folder-is-dangerous" />
</head><body class>
	<div id="wrapper">
		<div id="header">
			<div class="stripes">
				<span class="stripe el1"></span>
				<span class="stripe el2"></span>
				<span class="stripe el3"></span>
			</div>
            <div class="logo">
				<img height="119" width="119" class="left" alt="logo left" src="/_Resources/Static/Packages/matthias.kesenheimer/Images/Brand/r-left.svg">
				<img height="119" width="119" class="right" alt="logo right" src="/_Resources/Static/Packages/matthias.kesenheimer/Images/Brand/r-right.svg">
            </div>
            <div class="menu">
                <nav class="kesenheimer-matthias-menu"><ul>


<li class="">
    <a href="/about-me">Über mich</a>
</li>


<li class="current">
    <a href="/">Blog</a>
</li>


<li class="">
    <a href="/contact">Kontakt</a>
</li></ul></nav>
            </div>
		</div>

		<section id="content">
			<div class="neos-contentcollection">

<div class="paddingTop0 paddingBottom30 kesenheimer-matthias-container">
    <div class="inner container-fluid   ">
        <div class="neos-contentcollection">

<div class="paddingTop0 paddingBottom0 kesenheimer-matthias-headline">
	<div><h1 style="text-align:center">Why the .git folder is dangerous&nbsp;(a showcase)</h1>
</div>
</div>
<div class="paddingTop0 paddingBottom0 kesenheimer-matthias-text">
	<div><p style="text-align:center">In this blog article I will demonstrate how dangerous a public .git folder can be.</p>
</div>
</div></div>
    </div>
</div>

<div class="color-white paddingTop0 paddingBottom0 kesenheimer-matthias-container">
    <div class="inner container-fluid   ">
        <div class="neos-contentcollection"><div class="neos-nodetypes-html">
	<div class="paddingTop30 paddingBottom15 kesenheimer-matthias-warning">
  <div style="border: 1px solid #b93737; background: #ffdfdf; padding: 17px; border-radius: 3px; color: #773939; border-left-width: 10px;">
	<b>Important Notice:</b> In this article a vulnerability is demonstrated on a production context application. The shown vulnerability was <u>reported</u>. I contacted the BSI (Bundesamt für Sicherheit in der Informationstechnik) to initiate a Responsible Disclosure with the plattform operators. After the vulnerability was fixed I decided to publish this article.
  </div>
</div>
</div>


<div class="paddingTop15 paddingBottom15 kesenheimer-matthias-headline">
	<div><h2>What happend?</h2>
</div>
</div>
<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-text">
	<div><p>I came across a strong selling company that mainly sells products in the electric mobility and electric battery industries. I wanted to find out more about the online shop and its product range. In fact, the shop belonged to a company that also covers other product lines and operates several shops and brands.</p>

<p>So I checked which domains point to the server and found subdomains pointing to unprotected directories. I actually expected the HTTP status 403 (Forbidden), but got back 200 (OK). My interest was piqued.</p>
</div>
</div>

<div class="paddingTop0 paddingBottom30 kesenheimer-matthias-quote">
	<div><p>Please note that the name of the company and the&nbsp;affected URLs are not mentioned in the following article. This was a decision as a result of the Responsible Disclosure procedure.</p>
</div>
</div>

<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-headline">
	<div><h2>What is this blog article about?</h2>
</div>
</div>
<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-text">
	<div><p>Basically a process about how I discovered a vulnerability on a E-Commerce Shop which is basicly a multi shop instance for more than just one business under several domains.</p>

<p>I found a way to download private customer data which includes full names, e-mail adresses, payment information and delivery addresses. I got access to the full private source code which includes other sensitive configuration information and access data.</p>

<p>I had a detailed insight into the company's sales generated by all shops over the last 4 years. We're talking about <strong>millions of dollars</strong> and more than <strong>500.000 customer data records</strong>.</p>

<p>As the title suggests, the starting point of the attack is an unprotected .git directory. Some of you might already know that a non protected .git directory is a "no go". It was only at the beginning of this year that the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Chaos_Computer_Club">Chaos Computer Club</a> published a report that more than 50 leaks with 6.4 million data sets were found and reported via the CCC in a few weeks alone. The "public .git folder vulnerability" (CWE-527)&nbsp;has also been listed as one of the common attack scenarios.</p>

<p>My article takes up the topic again precisely because it is (unfortunately) still a common problem which needs definitly more attention.</p>
</div>
</div>

<div class="paddingTop0 paddingBottom30 kesenheimer-matthias-quote">
	<div><p>Please be assured that all screenshots shown personal data are censored. All data and files from this company <strong>have been removed</strong> from my Computer. <strong>No data has been leaked to public or otherwise published</strong>.</p>
</div>
</div>

<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-headline">
	<div><h2>Let's start with a&nbsp;proof of concept.</h2>
</div>
</div>
<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-text">
	<div><p>I think i don't have to mention why an enabled apache directory listning is <strong>never</strong> a good idea unless you <em>really</em> want to have that setting enabled. Well, in this case it was enabled and it was no problem to find the .git directory by bursting the url path.</p>
</div>
</div>
<div class="paddingTop0 paddingBottom0 kesenheimer-matthias-image">
	
<figure>
	


		
				
	<img title="Index of /.git" alt="Index of /.git" src="/_Resources/Persistent/5c29b2c8347e340c1d90aba2c4df9a89dfe435c8/git-folder-647x541.png" width="647" height="541" />

			
	


	
</figure>
</div><div class="row img-border_r4 paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
	<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 is-page neos-contentcollection">
<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-text">
	<div><p>There are many ways to expose this directory. The easiest way might be to use tools like <a target="_blank" rel="noopener" href="https://github.com/internetwache/GitTools">GitTools</a>. It's also no problem to <em>curl</em> the directories/files and simply run local a <em>git checkout -- .</em> which tells Git to checkout files by name/path in the current directory. That command basically recreates the source code from existing git. Anyway, i used the extractor.sh to get the data:</p>
</div>
</div></div><div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 is-page neos-contentcollection">
<div class="paddingTop0 paddingBottom0 kesenheimer-matthias-image">
	
<figure>
	


		
				
	<img title="censored data" alt="censored data" src="/_Resources/Persistent/d2dd32a11a9b8519f16b63749183ab3fd8c3eff2/expose_gittools.png" width="1226" height="292" />

			
	


	
</figure>
</div></div>
</div>


<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-headline">
	<div><h2>Analyse the source code</h2>
</div>
</div><div class="row img-border_r4 paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
	<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 is-page neos-contentcollection">
<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-text">
	<div><p>After i got access to the full source code I could analyse it and search for credentials and other vulnerabilities. It didn't take 5 Minutes to find a file named <em>inv-export.php.</em>&nbsp;The really interesting part was that username and password were given in plaintext directly in the file ?. Ok, there are credentials but what is this file doing anyway? After reading the first few lines of code it was very obvious that a customer and sale model was used to collect data directly from the database after a succesfull login though this "authentication process".</p>
</div>
</div></div><div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 is-page neos-contentcollection">
<div class="paddingTop0 paddingBottom0 kesenheimer-matthias-image">
	
<figure>
	


		
				
	<img title="source code" alt="source code" src="/_Resources/Persistent/ad4f3bdd5ee5038377898bd004ede6b2ef2aeee6/creds-789x94.png" width="789" height="94" />

			
	


	
</figure>
</div></div>
</div>
<div class="row img-border_r4 paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
	<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 is-page neos-contentcollection">
<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-text">
	<div><p>Ok, let's try to call that file in the live enviroment. I just had to change the domain from dev to prod and keep the path. Bingo! The file was existing. I checked some other resources in this context and they were all last modified on Tue, 12 Jan 2021 08:51:06 GMT. The checked file i got from git was commited 2018. So, did they changed something? Well.. no. The login worked anyway which means they didn't changed that hardcoded credentials for 4 years. After logged in I was able to download data from customer orders of <strong>all</strong> shop instances.</p>
</div>
</div></div><div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 is-page neos-contentcollection">
<div class="paddingTop0 paddingBottom0 kesenheimer-matthias-image">
	
<figure>
	


		
				
	<img title="censored data" alt="censored data" src="/_Resources/Persistent/8bb8de3e9089fa37127a71adffee6f3aff648aeb/customer.png" width="1859" height="509" />

			
	


	
</figure>
</div></div>
</div>

<div class="paddingTop0 paddingBottom30 kesenheimer-matthias-text">
	<div><p>Each line in this CSV file indicates an order. To get an idea of <strong>​​how</strong> <strong>much</strong> personal data could have leaked here over the last few years, you can put this together by looking at the small distances between the dates and times in the first column. ?</p>
</div>
</div>

<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-headline">
	<div><h2>But there is more...</h2>
</div>
</div><div class="row img-border_r4 paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
	<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 is-page neos-contentcollection">
<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-text">
	<div><p>Let's check the given config files. As you can see they are using a relational database service from Amazon which is&nbsp; a cloud based database. They are using a Aurora MySQL DB cluster.</p>
</div>
</div></div><div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 is-page neos-contentcollection">
<div class="paddingTop0 paddingBottom0 kesenheimer-matthias-image">
	
<figure>
	


		
				
	<img title="censored data" alt="censored data" src="/_Resources/Persistent/083ce1f88891a682aafaebf26ddd4587e12c5649/database-828x109.png" width="828" height="109" />

			
	


	
</figure>
</div></div>
</div>

<div class="paddingTop0 paddingBottom30 kesenheimer-matthias-text">
	<div><p>Too bad, they were saving such data via version control. Its a good advice to use environment variables for that or just .gitignore it. Anyway, after having full access to the development, staging and production databases, I stopped my research. At this point I had almost full control over the entire system.</p>
</div>
</div>

<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-headline">
	<div><h2>How can this still happen today?</h2>
</div>
</div>
<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-text">
	<div><p>This mostly happens due to incorrect deployment. There are developers who deploy their app to production or unprotected development instances using the Git clone method. They clone their repository and keep the .git folder in the web root. As you see, it becomes a real problem if this folder is publicly accessible.</p>

<p>Some of you say at this point that a build process is basically missing here. npm etc. Correct because then the .git folder could (for example) remain outside the document root. However, this is not always given and depends on the choosen technology.</p>

<p>But note: Even a Git directory in the documtent root with a disabled directory listing can be read out. Since the structure of the stored files follows a known scheme, it is also possible here to turn on the dirbuster and find important files at random.</p>

<p>It is all the more important to ensure that a .git directory is subsequently deleted or made inaccessible if it's exist. One solution (in this case apache) could be done via .htaccess or VirtualHost configuration:</p>
</div>
</div>
<div class="paddingTop0 paddingBottom30 kesenheimer-matthias-code">
	<pre class="line-numbers">
		<code class="language-php">
			<div>RewriteRule ^.*\.git.* - [R=404]</div>
		</code>
	</pre>
</div>
<div class="paddingTop0 paddingBottom30 kesenheimer-matthias-text">
	<div><p>the webserver now returns a 404 (not found) when someone tries to expose the directory. If you are not using apache you can google how to set a rewrite rule for your specific webserver.</p>
</div>
</div>

<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-headline">
	<div><h2>The Coordinated Vulnerability Disclosure process</h2>
</div>
</div><div class="row img-border_r4 paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
	<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 is-page neos-contentcollection">
<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-text">
	<div><p>Since this find was not just about a security vulnerability, but large amounts of personal data leaked out, I had to think carefully about how to report this to the operator.</p>

<p>I know from experience that direct contact with the operator is often not effective and there is a risk, too: As long as the hacker paragraph (202 StGB)&nbsp;in Germany is not abolished, the hacker has committed a crime, regardless of the motives or intentions. So, a white hat can get real problems like Lilith Wittmann last year. She noticed that a mobile app from CDU (a german political party) has some seriouse problems: She was able to read out member data via an public insufficiently protected API. After reporting the vulnerability to the party she received no thanks, but <a target="_blank" rel="noopener" href="https://netzpolitik.org/2021/cdu-connect-berliner-lka-ermittelt-gegen-it-expertin-die-sicherheitsluecken-in-partei-app-fand/">got a criminal complaint</a> from <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Landeskriminalamt">LKA</a>.</p>
</div>
</div></div><div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 is-page neos-contentcollection"><div class="row paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
	<div class="col-lg-4 col-md-6 col-sm-6 col-xs-12 is-page neos-contentcollection">
<div class="paddingTop0 paddingBottom0 kesenheimer-matthias-image">
	
<figure>
	


		
				
	<img title="shoot the messenger" alt="shoot the messenger" src="/_Resources/Persistent/861b79699bf1569bc0639ee19162efff16049e08/iRT.gif" width="250" height="275" />

			
	


	
</figure>
</div></div><div class="col-lg-8 col-md-6 col-sm-6 col-xs- is-page neos-contentcollection">
<div class="paddingTop0 paddingBottom15 kesenheimer-matthias-text">
	<div><p>So what now? There is also the possibility to report security vulnerability anonymously. In Germany, this could be reliably done via the <a target="_blank" rel="noopener" href="https://www.ccc.de/">CCC</a> or via the <a target="_blank" rel="noopener" href="https://www.bsi.bund.de/">BSI</a> (<a target="_blank" rel="noopener" href="https://www.cert-bund.de/">CERT Bund</a>). There is an intersting blog article (in german language) about that. It titled "<a target="_blank" rel="noopener" href="https://zerforschung.org/posts/rc3-2021/">Deine Software, die Sicherheitslücken und ich</a>" (Eng. "Your software, the security vulnerabilities and I") by ZERforschung. I really recommend reading this article which got me in the right direction.</p>

<p>In my case i reported the vulnerability to the BSI which was really unproblematic. They conteacted the company and the devs fixed the problem.</p>
</div>
</div></div>
</div>
</div>
</div>
</div>
    </div>
</div></div>
		</section>

		<section id="footer">
			<div class="footer_top inner">
				<div class="bg_image"></div>
			</div>
			<div class="footer_bottom">
				<div class="parallax">
					<div class="layer layer1"></div>
					<div class="layer layer2"></div>
					<div class="layer layer3"></div>
				</div>
			</div>
			<div class="footer_scene">
				<div class="inner">
					<div class="bg_image"></div>
					<a class="char" href="/world">
						<img alt="easter egg" src="/_Resources/Static/Packages/matthias.kesenheimer/Images/easter_egg.png" width="54" height="79">
						<div class="speak">
							<div class="boubble">
								Enter my world!
							</div>
						</div>
					</a>
				</div>
			</div>
			<div class="copy">
				<div class="inner">
					<div class="neos-contentcollection">
<div class="paddingTop15 paddingBottom15 kesenheimer-matthias-text">
	<div><p style="text-align:center">This website is powered by&nbsp;<a target="_blank" rel="noopener" href="https://neos.io">Neos</a><br />
<a href="/impressum">Impressum</a> | <a href="/datenschutz">Datenschutz</a></p>
</div>
</div></div>
				</div>
			</div>
		</section>
	</div>
<script data-neos-node="/sites/kesenheimer-matthias/node-auh0tef0k5fuq/node-16lrgl89esk1g@live;language=de" src="/_Resources/Static/Packages/Neos.Neos/JavaScript/LastVisitedNode.js" async></script></body></html>