<!DOCTYPE html>
<html lang="en">

<head>
    <base href="/mkesenheimer.github.io/" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#002241" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#002241" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="theme-color" content="#ffffff" />
    <link rel="stylesheet" media="all" href="/Resources/Static/Packages/matthias.kesenheimer/Styles/prism.css" />
    <link rel="stylesheet" media="all" href="/Resources/Static/Packages/matthias.kesenheimer/Styles/Main.min.css" />

    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/jQuery.js"></script>
    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/Plugins/anime.min.js" defer></script>
    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/Plugins/prism.js" defer></script>
    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/Plugins/chart.js" defer></script>
    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/Main.js" defer></script>
    <title>Physik, Elektronik und mehr... | Blog</title>
    <meta name="robots" content="index,follow" />
</head>

<body class>
    <div id="wrapper">
        <div id="header">
            <div class="menu">
                <nav class="paddingTop30 paddingBottom15 kesenheimer-menu">
                    <menu-ul>
                        <li class=""><a href="/about-me.html">Über mich</a></li>
                        <li class="current"><a href="/">Blog</a></li>
                        <li class=""><a href="/empty.html">Leer</a></li>
                        <li class=""><a href="/contact.html">Kontakt</a></li>
                    </menu-ul>
                </nav>
            </div>
        </div>

        <section id="content">
            <div class="neos-contentcollection">
                <div class="paddingTop0 paddingBottom30 kesenheimer-container">
                    <div class="inner container-fluid">
                        <div class="neos-contentcollection">
                            <div class="paddingTop0 paddingBottom0 kesenheimer-headline">
                                <div>
                                    <h1 style="text-align: center">PicoGlitcher PCB</h1>
                                </div>
                            </div>
                            <div class="paddingTop0 paddingBottom0 kesenheimer-text">
                                <div>
                                    <p style="text-align:center">A dirt chip fault-injection device</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Block -->
                <div class="color-white paddingTop0 paddingBottom0 kesenheimer-container">
                    <div class="inner container-fluid">
                        <div class="neos-contentcollection">
                            <!-- Text -->
                            <div class="neos-nodetypes-html">
                                <div class="paddingTop30 paddingBottom15 kesenheimer-text">
                                    <div>
                                        <div class="paddingTop0 paddingBottom15 kesenheimer-warning">
                                            <div>
                                                <p>I am now selling the PicoGlitcher on <a href="https://www.tindie.com/products/faulty-hardware/picoglitcher-v11/">tindie.com</a>.</p>
                                            </div>
                                        </div>
                                        <div class="paddingTop15 paddingBottom30 kesenheimer-warning">
                                            <div>
                                                <p>This projected was kindly supported by JLCPCB which is a PCB manufacturer trusted by 5.4M Engineers Worldwide. You can get high-quality PCB prototypes for just $2. If you use the following link to sign up, you can get up to $80 coupons: <a href="https://jlcpcb.com/?from=matthias">https://jlcpcb.com/?from=matthias</a></p>
                                            </div>
                                            <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                                <figure>
                                                    <img title="" alt="" src="/Resources/Persistent/2024/09/jlcpcb.png" width="3264" height="2448" />
                                                </figure>
                                            </div>
                                        </div>
                                        <p><strong>
                                            Update: Many thanks to Troed Sångberg who successfully built a PicoGlitcher.
                                            For his built, he made a parts list on Mouser which you can find &nbsp;<a href="https://cdn.hackaday.io/files/1963578400937888/Project_Sep13_0320AM.xls">here</a>.
                                        </strong></p>

                                        <p>
                                            This project is intended to make fault injection attacks against microcontrollers accessible for hobbyists and to introduce the topic of voltage glitching.
                                            The software offers an easy entry point to carry out your own attacks against microcontrollers, SoCs and CPUs.
                                            With the provided and easy to use functions and classes, fault injection projects can be realized quickly.
                                        </p>
                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2024/09/finished.jpg" width="3264" height="2448" />
                                            </figure>
                                        </div>
                                        <p>
                                            Voltage glitching attacks are usually done with expensive hardware such as the ChipWhisperer Pro or Husky.
                                            However, for most of the attacks a Raspberry Pi Pico and a few other components are required.
                                            In order to achieve the best results, a circuit board was developed to combine the best of both worlds: cheap, easy to use and powerful.
                                        </p>
                                        <div class="paddingTop15 paddingBottom15 kesenheimer-headline">
                                            <div>
                                                <h2>Introduction</h2>
                                            </div>
                                        </div>
                                        <p>
                                            Voltage glitching attacks are a class of hardware attacks that exploit the vulnerability of electronic systems to sudden and brief changes in their power supply voltage.
                                            By intentionally introducing these abrupt voltage changes, or "glitches," attackers aim to disrupt the normal operation of the target device, causing it to malfunction in a controlled manner.
                                            This can result in the bypassing of security measures, corruption of data, or unintended execution of code. Voltage glitching is particularly relevant in the context of embedded systems, such as microcontrollers and smart cards, which are commonly used in secure applications including payment systems, access controls, and IoT devices.
                                        </p>
                                        <p>
                                            The core concept behind voltage glitching is to induce faults at precise moments during the execution of critical operations within the device.
                                            These faults can lead to outcomes such as skipping security checks, extracting secret keys, or gaining unauthorized access to protected functions.
                                            The success of a voltage glitching attack relies on careful timing and an understanding of the target device's behavior under different power conditions.
                                            Attackers often use specialized equipment to generate and control these glitches with high precision, making this technique both sophisticated and powerful.
                                        </p>
                                        <div class="paddingTop15 paddingBottom15 kesenheimer-headline">
                                            <div>
                                                <h2>Previously featured projects</h2>
                                            </div>
                                        </div>
                                        <p>
                                            Glitching has been previously described on Hackaday for example&nbsp;<a href="https://hackaday.com/2022/08/25/everything-you-didnt-know-you-need-to-know-about-glitching-attacks/" target="_blank" rel="noreferrer noopener">here (everything you didn't know you need to know about glitching attacks)</a>&nbsp;or&nbsp;<a href="https://hackaday.com/2022/07/14/apple-airtags-hacked-and-cloned-with-voltage-glitching/">here (Apple Airtags hacked and cloned with voltage glitching)</a>.
                                            The latter even describes attacking an Apple Airtag with a Raspberry Pi Pico and a mosfet.&nbsp;
                                        </p>
                                        <div class="paddingTop15 paddingBottom15 kesenheimer-headline">
                                            <div>
                                                <h2>Existing hardware</h2>
                                            </div>
                                        </div>
                                        <p>
                                            Usually these attacks are carried out by expensive hardware such as the&nbsp;<a href="https://rtfm.newae.com/Capture/ChipWhisperer-Pro/">ChipWhisperer Pro</a>, the&nbsp;<a href="https://rtfm.newae.com/Capture/ChipWhisperer-Husky/">ChipWhisperer Husky</a>, or the devices from&nbsp;<a href="https://getquote.riscure.com/en/quote/2101114/vc-glitcher.htm">Riscure</a>.
                                            As these devices are typically very expensive (several hundred Euros), they are not accessible for the hobby hacker. The ChipWhisperer Husky is even more inaccessible for hobby hackers since it has long shipping times up to several weeks.
                                        </p>
                                        <div class="paddingTop15 paddingBottom15 kesenheimer-headline">
                                            <div>
                                                <h2>The PicoGlitcher</h2>
                                            </div>
                                        </div>
                                        <p>
                                            It turns out, however, that voltage glitching attacks can easily be performed with cheap and available hardware like the Rapberry Pi Pico and some other components.
                                            The sampling rate of the Raspberry Pi Pico is fast enough to enable attacks against most common microcontrollers like the ESP32 or STM32 processors.
                                            To gain more insight into voltage glitching attacks and using only cheap components, the PicoGlitcher was born.
                                        </p>
                                        <p>
                                            The hardware required for the PicoGlitcher involves, of course, a Raspberry Pi Pico and additional components for precise voltage control and monitoring.
                                            Specifically, it includes a power supply capable of switching the target on and off, and crowbar transistors that can switch up to 66 amps.
                                            The design of the voltage glitching stage of the PicoGlitcher is exactly the same as found in the ChipWhisperer Pro.
                                            Furthermore, the board provides several different voltages to supply all kinds of different target boards.
                                            A built-in level shifter translates between the fixed voltages of the Raspberry Pi Pico and the voltage levels of the target board.
                                        </p>
                                        <p>
                                            Glitches must be placed very precisely.
                                            The PicoGlitcher is able to trigger on various external events.
                                            For example, a rising or falling edge could be used to start the timers.
                                            Additionally, the PicoGlitcher can sniff on a UART communication and trigger if a specific word is sent.
                                        </p>
                                        <p>
                                            To summarize:
                                        </p>
                                        <ul>
                                            <li>The PicoGlitcher is cheap (less than 30€) in comparison to professional equipment</li>
                                            <li>Various trigger capabilities: Rising or falling edge trigger, UART trigger, etc.</li>
                                            <li>Level shifters to trigger on signals with different voltage level.</li>
                                            <li>Low and high power crowbar mosfets to switch up to 66 amps.</li>
                                            <li>SMA connectors for the glitch output and ADC input.</li>
                                            <li>Trigger Sampling rate up to 125MHz, meaning a glitching resolution under 10ns.</li>
                                            <li>A software-controllable voltage output. This can be used to supply the target and to switch it on and off if hard errors occur.</li>
                                            <li>Voltage outputs from 1.8V, 3.3V to 5V.</li>
                                            <li>Fully customizable and easy to understand software: main language is Python and MicroPython</li>
                                        </ul>
                                        <div class="paddingTop15 paddingBottom15 kesenheimer-headline">
                                            <div>
                                                <h2>The Software</h2>
                                            </div>
                                        </div>
                                        <p>
                                            The corresponding software, the "fault-injection-library", is a Python library specifically designed to perform fault injection attacks on microcontrollers.
                                            To set it up, clone the repository, create a virtual environment, and install the necessary dependencies using pip.
                                            The Raspberry Pi Pico is used for executing these attacks, and the required MicroPython scripts must be uploaded to the device. Example scripts for performing attacks and analyzing results are provided, demonstrating how to manipulate target devices by injecting precise voltage glitches.
                                        </p>
                                        <p>
                                            The fault-injection-library also supports the ChipWhisperer hardware (Pro and Husky).
                                            So if you have access to these tools, you can use this library to perform fault injection attacks.
                                        </p>
                                        <p>
                                            For more details, visit the&nbsp;<a href="https://github.com/MKesenheimer/fault-injection-library">GitHub page</a>.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="row paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
                                <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12 is-page neos-contentcollection"></div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 is-page neos-contentcollection"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Block -->
                <div class="color-white paddingTop30 paddingBottom0 kesenheimer-container">
                    <div class="inner container-fluid">
                        <div class="neos-contentcollection">
                            <!-- Text -->
                            <div class="neos-nodetypes-html">
                                <div class="paddingTop30 paddingBottom15 kesenheimer-text">
                                    <div class="paddingTop0 paddingBottom15 kesenheimer-headline">
                                        <div>
                                            <h1>September 12 2024: Assembly of the updated PCBs</h1>
                                        </div>
                                    </div>
                                    <div>
                                        <p>After ten days I received my order from <a href="http://jlcpcb.com">JLCBCP</a>. As mentioned in the previous project log, generating the design files (gerber, CPL and BOM) was fairly straight forward.</p>

                                        <p>The finished PCBs are of high quality. I could not find any errors and the components are perfectly placed and soldered. I am really happy with the way the PicoGlitcher PCB turned out.</p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2024/09/IMG_6765.JPG" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p>The next step was to solder the rest of the components onto the board. For example, the Raspberry Pi Pico and some other through-hole components have to be soldered by hand. The finished board can be seen below.</p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2024/09/IMG_6766.JPG" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p>The new design also works flawlessly. I could generate reproducible glitches on a STM microcontroller within a few minutes.</p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2024/09/IMG_6767.JPG" width="3264" height="2448" />
                                            </figure>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
                                <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12 is-page neos-contentcollection"></div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 is-page neos-contentcollection"></div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Block -->
                <div class="color-white paddingTop30 paddingBottom0 kesenheimer-container">
                    <div class="inner container-fluid">
                        <div class="neos-contentcollection">
                            <!-- Text -->
                            <div class="neos-nodetypes-html">
                                <div class="paddingTop30 paddingBottom15 kesenheimer-text">
                                    <div class="paddingTop0 paddingBottom15 kesenheimer-headline">
                                        <div>
                                            <h1>September 3 2024: PCB updates</h1>
                                        </div>
                                    </div>
                                    <div>
                                        <p>First of all, the design of the PicoGlitcher is good and I have not found any major flaws yet. The PicoGlitcher works.</p>

                                        <p>However, I have noticed that some of the PCB markings are hard to read, and some are even missing. The component placement is also not optimal, so I decided to update the PCB files. Soldering the small SMD components by hand was difficult (for me at least), so I decided to give PCB manufacturing with component placement a try.</p>

                                        <p>I made a few changes to the design files, picked all the components from <a href="http://jlcpcb.com">JLCPCB</a> via the <a href="https://jlcpcb.com/parts/componentSearch">Assembly Parts Lib</a>&nbsp;and uploaded the new gerber files. In order to automatically generate the BOM and the component placement file (CPL) in Fusion360, I used the library <a href="https://github.com/JLCPCB/jlcpcb-eagle">jlcpcb-eagle</a>. With the gerber, the BOM and the CPL files ready, I was finally able to submit my order to&nbsp;JLCPCB. All the relevant files can be found on my <a href="https://github.com/MKesenheimer/fault-injection-library/tree/master/schematics">github</a> page.&nbsp;</p>

                                        <p>I was surprised at how easy the whole procedure was. The JLCPCB parts library is huge and if an exact part is not available, there is always an alternative. What's more, every step of the process is easy to understand. The component placement is displayed in an online tool that allows you to check that all the components have been placed correctly. Manufacturing and shipping was fast. I received my order within ten days.</p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2024/09/pico-glitcher-v1.1.png" width="3264" height="2448" />
                                            </figure>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
                                <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12 is-page neos-contentcollection"></div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 is-page neos-contentcollection"></div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <section id="footer">
            <div class="copy">
                <div class="inner">
                    <div class="neos-contentcollection">
                        <div class="paddingTop15 paddingBottom15 kesenheimer-text">
                            <div>
                                <p style="text-align:center">
                                    <a href="/impressum.html">Impressum</a>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</body>
</html>
