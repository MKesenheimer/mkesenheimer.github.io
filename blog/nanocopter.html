<!DOCTYPE html>
<html lang="en">

<head>
    <base href="/mkesenheimer.github.io/" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#002241" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#002241" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="theme-color" content="#ffffff" />
    <link rel="stylesheet" media="all" href="/Resources/Static/Packages/matthias.kesenheimer/Styles/prism.css" />
    <link rel="stylesheet" media="all" href="/Resources/Static/Packages/matthias.kesenheimer/Styles/Main.min.css" />

    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/jQuery.js"></script>
    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/Plugins/anime.min.js" defer></script>
    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/Plugins/prism.js" defer></script>
    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/Plugins/chart.js" defer></script>
    <script src="/Resources/Static/Packages/matthias.kesenheimer/JavaScript/Main.js" defer></script>
    <title>Physik, Elektronik und mehr... | Blog</title>
    <meta name="robots" content="index,follow" />
</head>

<body class>
    <div id="wrapper">
        <div id="header">
            <div class="menu">
                <nav class="paddingTop30 paddingBottom15 kesenheimer-menu">
                    <menu-ul>
                        <li class=""><a href="/about-me.html">Über mich</a></li>
                        <li class="current"><a href="/">Blog</a></li>
                        <li class=""><a href="/blog/pico-glitcher-v2.html">Pico Glitcher</a></li>
                        <li class=""><a href="/contact.html">Kontakt</a></li>
                    </menu-ul>
                </nav>
            </div>
        </div>

        <section id="content">
            <div class="neos-contentcollection">
                <div class="paddingTop0 paddingBottom30 kesenheimer-container">
                    <div class="inner container-fluid">
                        <div class="neos-contentcollection">
                            <div class="paddingTop0 paddingBottom0 kesenheimer-headline">
                                <div>
                                    <h1 style="text-align: center">Nanocopter</h1>
                                </div>
                            </div>
                            <div class="paddingTop0 paddingBottom0 kesenheimer-text">
                                <div>
                                    <p style="text-align:center">Mit minimalen Bauteilen in die Luft</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Block -->
                <div class="color-white paddingTop0 paddingBottom0 kesenheimer-container">
                    <div class="inner container-fluid">
                        <div class="neos-contentcollection">
                            <div class="neos-nodetypes-html">
                                <div class="paddingTop30 paddingBottom15 kesenheimer-text">
                                    <div>
                                        <p>Einen Quadrocopter kennen vielleicht viele von euch, aber kennt ihr auch einen Nano-Quadrocopter, der nur aus einer einzigen Platine und aus vier Motoren besteht? Wahrscheinlich eher nicht :) Die Idee ist nicht ganz neu und auch nicht meine eigene, trotzdem ist dieser Quadrocopter eine Selbstentwicklung von mir. Der Schaltplan, das Layout, die Lötarbeit und letztendlich die Software; eben alles was dazugehört.</p>

                                        <p>Mein Ziel war es mit möglichst geringem Aufwand und mit sehr wenigen Bauteilen einen Low-Budget Quadrocopter zu bauen, der seinen großen Brüdern in nichts nachsteht. Im Verlauf des Projekts stellte es sich dann allerdings heraus, dass ich mich mit den Ausgaben ein bisschen verschätzt hatte. Es summierte sich im Laufe der Entwicklung schon so einiges auf, was auch daran lag, dass ich mir für dieses Projekt einen Programmier- und Debug-Adapter kaufen musste um eine Möglichkeit zu haben schnell und effizient Fehler im Programmcode zu finden.</p>

                                        <p>Das teuerste Bauteil ist der 4x4mm große Beschleunigungs- und Gyrosensor mit 25€, dementsprechend groß war die Anspannung, als ich die 24 haarfeinen Lötpins des QFN-Gehäuses verlötet habe.</p>

                                        <p>Mit meinem Quadrocopter-Projekt habe ich im Juni 2012 angefangen, als ich ein paar spektakuläre Videos von diversen Quadrocoptern auf Youtube gesehen habe. Hier zum Beispiel ein kleines Video von Nanocoptern, die die Titelmelodie zu James Bond spielen:</p>

                                        <iframe width="707" height="398" src="https://www.youtube.com/embed/_sUeGC-8dyk?si=OY2q0BxIjivK0TOr" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

                                        <p>Ab da ging es mit dem Projekt langsam aber stetig voran. Ich schaute mich bei ebay nach einem geeigneten RC-Sender und Empfänger um und machte die ersten Entwürfe für die Schaltung. Währenddessen erkundigte ich mich in unterschiedlichen Foren oder bei verschiedenen Webseiten über schon bestehende Quadrocopter-Projekte.</p>

                                        <p><a href="http://www.rclineforum.de/forum/board35-helicopter/board84-multicopter/board186-multicopter-einsteiger/">RC-Line Forum</a><br />
                                        <a href="http://members.vol.at/pi/mini_ufo/mini_ufo.html">Pi's Website</a><br />
                                        <a href="http://shrediquette.blogspot.de/">Shrediquette</a><br />
                                        <a title="Homepage öffnen" href="http://www.harald-sattler.de/default.htm" target="_blank">Harald Sattler</a></p>

                                        <p>Dumm nur, dass mir kein Projekt, bei dem sowohl Software als auch Hardware frei zugänglich war, so richtig auf Anhieb gefiel. Und Projekte, die ich richtig cool fand und bei denen mir auch das Layout und die Einfachheit des Quadros gefielen, waren leider kommerziell, weshalb der Schaltplan und das Platinenlayout nicht für jedermann verfügbar waren. Also musste der Eigenbau her.</p>

                                        <p>Ich entschied mich für einen 32MHz ATxMega-Prozessor und den Beschleunigungssensor MPU6050 von Invensense, der zwar nicht ganz billig war, aber sehr gute Ergebnisse liefert. Normalerweise wird dieser Beschleunigungs- und Gyrosensor in Smartphones oder Navigationssystemen eingebaut.</p>

                                        <p>Die Eckdaten des Nanocopters im Überblick:</p>
                                        <ul>
                                            <li>ATxMega32A4U, 32MHz (er kann alles was das Mikrokontrollerherz begehrt ;))</li>
                                            <li>MPU6050, 2000 deg/sec Samplingrate</li>
                                            <li>340mAh Lion Akku, damit erwartete Flugdauer von etwa 8min</li>
                                            <li>4 Miniatur Bürstenmotoren aus Ersatzteilen von einem kommerziellen Nanocopter (Walkera Lady Bird)</li>
                                        </ul>

                                        <p>Nach vielen, vielen Arbeitsstunden am Computer stellte ich den Schaltplan und das Layout fertig.</p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="Layout des Nano-Quadrocopters" alt="" src="/Resources/Persistent/2012/10/layout.png" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p>Die Firma <a href="http://www.seeedstudio.com/depot">Seeedstudio</a> stellte die PCB Platinen innerhalb eines Monats her, weshalb ich viel Zeit hatte in Ruhe die benötigten Bauteile bei <a href="http://digikey.com">Digikey</a> zu bestellen. Als mir nach etlichen Anlaufschwierigkeiten endlich die Bauteile geschickt wurden, konnte ich den Nanocopter nach meinen Fertigungsplänen zusammenlöten.</p>
                                            
                                        <p>Das Ergebnis sieht denke ich ganz passabel aus:</p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2012/10/cimg9318.jpg" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2012/10/cimg9605.jpg" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2012/10/cimg9612.jpg" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p>Achtet auf den unglaublich kleinen (4x4mm) Sensor in der Mitte der Platine (kleines schwarzes Quadrat). Es war gar nicht so einfach seine winzigen Pins zu verlöten.</p>

                                        <p>Als nächstes wurden die ersten Versuche gestartet für dieses Ding eine Software zu schreiben. Eine I2C Kommunikation zwischen Mikrocontroller und IMU (Beschleunigungs- und Gyrosensor MPU6050) musste aufgebaut, die Motoren über PWM angesteuert und eine PID Regelschleife programmiert werden. Alles nicht so einfach, wie ich mir das am Anfang vorgestellt hatte, aber das folgende Video zeigt, dass mein Projekt doch sehr vielversprechend ist:</p>

                                        <iframe width="707" height="398" src="https://www.youtube.com/embed/UT3WbKGzFEA?si=ZaJMfU7kH9E3KjVq" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

                                        <p>In den nächsten Tagen muss ich noch den Empfänger auf den Nanocopter montieren und das Programm für den Empfang der Empfängerdaten erweitern. Wenn alles gut geht, dürfte der Nanocopter in wenigen Wochen flugbereit sein :) (Aber ich kenne diesen Satz langsam von mir, und aus den Wochen werden Monate…)</p>

                                        <p>Die Software und alle anderen Projektunterlagen sind <a href="https://github.com/MKesenheimer/QDC_MK1_Quadrocopter">hier</a> zu finden.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="row paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
                                <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12 is-page neos-contentcollection"></div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 is-page neos-contentcollection"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Block -->
                <div class="color-white paddingTop30 paddingBottom0 kesenheimer-container">
                    <div class="inner container-fluid">
                        <div class="neos-contentcollection">
                            <div class="neos-nodetypes-html">
                                <div class="paddingTop30 paddingBottom15 kesenheimer-text">
                                    <div class="paddingTop0 paddingBottom15 kesenheimer-headline">
                                        <div>
                                            <h1>18. April 2013: Update</h1>
                                        </div>
                                    </div>
                                    <div>
                                        <p>Endlich! Die Software womit ich auf die Daten meines Nanocopters zugreifen kann funktioniert!</p>

                                        <iframe width="707" height="398" src="https://www.youtube.com/embed/XVW0aptW15s?si=RGPV3rYgx2RqLOkk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                                    </div>

                                    <p>Es war ein langer Weg bis zu dieser Software, vor allem weil ich mich bisher nicht mit Cocoa und Objective-C auskannte. Wie im Video zu sehen ist, werden die Winkel der Nick- und Rollachse auf einem Graph ausgegeben. Die Videoqualität ist zwar nicht so gut, aber ich glaube man erkennt so einigermaßen, was die Software macht. Geplant ist in nächster Zeit die Software für weitere wichtige Daten zu erweitern. Schlussendlich möchte ich mit der Software die PID-Reglerwerte für meinen Quadrocopter genau einstellen können.</p>
                                </div>
                            </div>
                            <div class="row paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
                                <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12 is-page neos-contentcollection"></div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 is-page neos-contentcollection"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Block -->
                <div class="color-white paddingTop30 paddingBottom0 kesenheimer-container">
                    <div class="inner container-fluid">
                        <div class="neos-contentcollection">
                            <div class="neos-nodetypes-html">
                                <div class="paddingTop30 paddingBottom15 kesenheimer-text">
                                    <div class="paddingTop0 paddingBottom15 kesenheimer-headline">
                                        <div>
                                            <h1>31. Januar 2014: Der Nano-Quadrocopter geht in die zweite Runde</h1>
                                        </div>
                                    </div>
                                    <div>
                                        <p>Nach langer Wartezeit gibt es jetzt endlich mal wieder ein paar Updates und sogar erste Codeschnippsel. Ich muss leidvoll gestehen, dass ich nur sehr langsam an diesem Projekt weiterkomme, aber was mittlerweile daraus geworden ist, seht ihr hier.</p>

                                        <p>Tja, eine Diplomarbeit zu schreiben benötigt viel Zeit und Aufmerksamkeit. Deshalb geht es mit meinen anderen Projekten nur sehr langsam voran. Aber ich habe vor einigen Wochen Verstärkung bekommen! Ja, das glaubt man kaum, aber ich arbeite mittlerweile mit <a href="http://www.harald-sattler.de/html/xnq.htm">Harald Sattler</a> zusammen, der selbst an einem Quadrocopter-Projekt bastelt. Durch ihn hat mein Projekt neuen Schub bekommen, weshalb ich euch meine Fortschritte zeigen möchte. Harald arbeitet mit einem ähnlichen Setup. Er verwendet ebenfalls einen XMega32 Prozessor, seine Schaltung ist größtenteils identisch (bis auf Pinbelegung) zu meiner Schaltung, deshalb bietet es sich an, an einem gemeinsamen Code zu schreiben. Doch alles Schritt für Schritt.</p>

                                        <p>Zuerst einmal etwas zur <a href="http://www.mediafire.com/download/xu586e7fupqppk6/QuadroCalibration.zip">Benutzeroberfläche</a>, mit der man meinen Quadrocopter einstellen und wichtige Daten sichtbar machen lassen kann. Die Benutzeroberfläche wurde für Mac OS X in Cocoa - eine spezielle Programmiersprache für die Oberflächen von Mac OS X - von mir geschrieben. Der Quadrocopter kommuniziert mit diesem Programm über eine serielle Schnittstelle, beispielsweise über einen USB-To-Seriell-Adapter oder über einen <a href="http://arduino.cc/">Arduino</a>. Auf Befehl des Programms sendet der Quadrocopter entweder die aktuellen Winkel- oder bestimmte Debugwerte und trägt sie in einem Diagramm gegen die Zeitachse ab. Damit ist eine sehr gute Datenkontrolle möglich und man sieht ganz genau, was auf dem Quadrocopter gerade so passiert.</p>

                                        <p>Die Oberfläche ist an sich selbsterklärend. Es gibt einen Bereich wo die vom Quadrocopter empfangene Daten abgetragen werden und einen Bereich wo man neue Daten eintragen kann, um sie an den Quadrocopter zu schicken. Diese Daten können zum Beispiel bestimmte Konfigurationswerte für die PID-Regelschleife sein. Außerdem lassen sich über die Benutzeroberfläche die Motoren starten oder ausschalten, falls das aus irgendwelchen Gründen nötig sein sollte.</p>

                                        <div class="paddingTop0 paddingBottom30 kesenheimer-image">
                                            <figure>
                                                <img title="" alt="" src="/Resources/Persistent/2014/01/gui.png" width="3264" height="2448" />
                                            </figure>
                                        </div>

                                        <p>Den Code der Benutzeroberfläche habe ich <a href="https://github.com/MKesenheimer/QDC_MK1_Quadrocopter">hier</a> veröffentlicht. Natürlich ist er mit Vorsicht zu genießen. Es ist noch nicht die endgültige Version und im Laufe der Entwicklung kann sich vielleicht noch einiges ändern. Zum Beispiel das Format des Datenstromes möchte ich bei Gelegenheit noch anpassen. Bis jetzt werden einzelne Datensätze als Ascii-Werte, die mit Kommas oder Strichpunkt voneinander getrennt sind, an die serielle Schnittstelle geschickt und vom Programm als String eingelesen. Ein Algorithmus trennt die einzelnen Datensätze voneinander und konvertiert sie wieder in Integer oder Double Werte. Das ist nicht sehr elegant und kann bestimmt irgendwie optimiert werden. Aber das hat denke ich noch Zeit. Zuerst sind andere Sachen wichtiger. Wen die Hintergründe genauer interessieren, sollte den Code herunterladen und darin stöbern. Die Routinen, die die Kommunikation zur serielle Schnittstelle bereitstellen, sind von einem anderen Projekt (<a href="https://github.com/armadsen/ORSSerialPort">ORSSerialPort</a>) kopiert.</p>

                                        <p>Zu meinem Quadrocopter selber kann ich euch schon einmal diesen Code als Vorabversion präsentieren: <a href="http://www.mediafire.com/download/fr4bpz8df4jhjb1/xNQ_QDC.zip">xNQ_QDC</a>. Wie gesagt, ist dieser Code in Zusammenarbeit mit <a href="http://www.harald-sattler.de/html/xnq.htm">Harald Sattler</a> entstanden und eine Portierung der Multi-Wii-Firmware. Durch die Adaptierung an den XMega Prozessor geht einiges an Funktionalität der Multi-Wii-Firmware verloren, aber das meiste wird für meinen (und auch für Haralds) Quadrocopter nicht benötigt. Falls ihr beabsichtigt diesen Code zu verwenden denkt daran, dass womöglich einige Port Zuordnungen oder Timer an euer Projekt angepasst werden müssen. Noch ein Hinweis: Die Codeteile für meinen Quadrocopter (können mit #define QDCMK ausgewählt werden) funktionieren noch nicht alle. Die Codeteile von Haralds Quadrocopter (#define xNQ) funktionieren allerdings schon sehr gut, er konnte mit diese Code schon fliegen. Außerdem ist diese Firmware Version nicht mit der oben beschriebenen graphischen Benutzeroberfläche für Mac OS X kompatibel, sondern mit der GUI der Multi-Wii-Software, die <a href="https://code.google.com/p/mw-wingui/">hier</a> zu finden ist.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="row paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
                                <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12 is-page neos-contentcollection"></div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 is-page neos-contentcollection"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Block -->
                <div class="color-white paddingTop30 paddingBottom0 kesenheimer-container">
                    <div class="inner container-fluid">
                        <div class="neos-contentcollection">
                            <div class="neos-nodetypes-html">
                                <div class="paddingTop30 paddingBottom15 kesenheimer-text">
                                    <div class="paddingTop0 paddingBottom15 kesenheimer-headline">
                                        <div>
                                            <h1>25. September 2014: Update</h1>
                                        </div>
                                    </div>
                                    <div>
                                        <p>Das ganze Projekt ist seit neuestem auch auf meiner Github-Seite zu finden: <a href="https://github.com/MKesenheimer/QDC_MK1_Quadrocopter">QDC_MK1_Quadrocopter</a></p>

                                        <p>Es wurden in den letzten Tagen einige Änderungen am bestehenden Code vorgenommen, z.B. wurde der unverständliche PID-Algorithmus der MultiWii-Firmware durch einen eigenen Algorithmus ausgetauscht. Obwohl nun Fließkomma-Berechnungen vom Mikrokontroller durchgeführt werden müssen, ändert sich die Geschwindigkeit der PID-Schleife nicht. Im Gegenteil, die Schleifenfrequenz beträgt nun satte 800Hz! Desweiteren werden die Winkel anders berechnet und die Filterung der Daten geschieht nun durch einen Kalman Filter. Insgesamt ist der Code nun (hoffentlich) besser verständlich und klarer strukturiert als der ursprüngliche MultiWii-Code. Die ersten Flugversuche fallen ebenfalls sehr positiv aus.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="row paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
                                <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12 is-page neos-contentcollection"></div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 is-page neos-contentcollection"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Block -->
                <div class="color-white paddingTop30 paddingBottom0 kesenheimer-container">
                    <div class="inner container-fluid">
                        <div class="neos-contentcollection">
                            <div class="neos-nodetypes-html">
                                <div class="paddingTop30 paddingBottom15 kesenheimer-text">
                                    <div class="paddingTop0 paddingBottom15 kesenheimer-headline">
                                        <div>
                                            <h1>5. Oktober 2014: Jungfernflug</h1>
                                        </div>
                                    </div>
                                    <div>
                                        <p>Nach mehr als zwei Jahren und unzähligen Stunden am PC zur Programmierung der Software ist es nun endlich soweit. Der kleine Quadrocopter, der nur aus einer Platine und aus vier Motoren besteht, fliegt! Die PID-Regelung zur Stabilisierung kann noch verbessert werden, aber das kleine Flugmodell ist jetzt schon flugfähig und mit ein bisschen Geschick gut steuerbar.</p>

                                        <p>Hier der Erstflug:</p>
                                        
                                        <iframe width="707" height="398" src="https://www.youtube.com/embed/egbYW9YKekU?si=Z2_QOt0beO6YomOs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                                    </div>
                                </div>
                            </div>
                            <div class="row paddingTop0 paddingBottom30 neos-nodetypes-twocolumn">
                                <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12 is-page neos-contentcollection"></div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 is-page neos-contentcollection"></div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <section id="footer">
            <div class="copy">
                <div class="inner">
                    <div class="neos-contentcollection">
                        <div class="paddingTop15 paddingBottom15 kesenheimer-text">
                            <div>
                                <p style="text-align:center">
                                    <a href="/impressum.html">Impressum</a>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</body>
</html>